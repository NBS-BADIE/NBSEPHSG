{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    /* Variables CSS pour les thèmes */
    :root {
        --primary-blue: #1a6dbb;
        --dark-blue: #0d4d8c;
        --light-blue: #e9f2fa;
        --background-blue: #f0f7ff;
        
        /* Variables pour le mode clair (par défaut) */
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fa;
        --bg-tertiary: #e9ecef;
        --text-primary: #212529;
        --text-secondary: #495057;
        --card-bg: #ffffff;
        --card-shadow: rgba(0, 0, 0, 0.1);
        --border-color: rgba(0, 0, 0, 0.1);
        --section-bg: #f8f9fa;
        --header-bg: linear-gradient(135deg, var(--primary-blue) 0%, var(--dark-blue) 100%);
        --highlight-bg: var(--light-blue);
        --nav-bg: rgba(255, 255, 255, 0.95);
        --nav-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    /* Variables pour le mode nuit */
    body.dark-mode {
        --bg-primary: #121212;
        --bg-secondary: #1e1e1e;
        --bg-tertiary: #2d2d2d;
        --text-primary: #e0e0e0;
        --text-secondary: #b0b0b0;
        --card-bg: #1e1e1e;
        --card-shadow: rgba(0, 0, 0, 0.25);
        --border-color: rgba(255, 255, 255, 0.1);
        --section-bg: #2d2d2d;
        --header-bg: linear-gradient(135deg, #1a2c3f 0%, #2d4466 100%);
        --highlight-bg: rgba(26, 109, 187, 0.15);
        --nav-bg: rgba(30, 30, 30, 0.95);
        --nav-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }
    
    /* Navigation interne fixe */
    .internal-nav-fixed {
        position: fixed;
        top: 70px; /* Ajustez selon la hauteur de votre navbar principale */
        left: 0;
        right: 0;
        z-index: 1000;
        background: var(--nav-bg);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border-color);
        padding: 0.75rem 0;
        box-shadow: var(--nav-shadow);
        transition: all 0.3s ease;
    }
    
    .internal-nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 15px;
    }
    
    .internal-nav-scrolled {
        top: 60px; /* Réduire la hauteur quand on scroll */
        padding: 0.5rem 0;
        background: rgba(255, 255, 255, 0.98);
        box-shadow: 0 2px 8px var(--card-shadow);
    }
    
    body.dark-mode .internal-nav-scrolled {
        background: rgba(30, 30, 30, 0.98);
    }
    
    /* Ajouter un padding au body pour compenser la navbar fixe */
    body {
        padding-top: 120px; /* Ajustez selon la hauteur totale des navbars */
        background-color: var(--bg-primary);
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease;
    }
    
    /* Ajustement pour mobile */
    @media (max-width: 768px) {
        .internal-nav-fixed {
            top: 60px;
            padding: 0.5rem 0;
        }
        
        body {
            padding-top: 100px;
        }
        
        .internal-nav-scrolled {
            top: 50px;
        }
        
        .internal-nav-container .d-inline-flex {
            justify-content: center;
            gap: 0.5rem !important;
        }
        
        .internal-nav-container .btn {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
    }
    
    .hospital-header {
        background: var(--header-bg);
        color: white;
        padding: 3rem 0;
        text-align: center;
        margin-bottom: 2rem;
        border-radius: 0 0 10px 10px;
        margin-top: 20px; /* Espace sous la navbar fixe */
    }
    
    .hospital-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }
    
    .hospital-header .subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .info-section {
        margin-bottom: 3rem;
        padding-top: 80px; /* Pour éviter que le contenu soit caché sous la navbar fixe */
        margin-top: -60px; /* Compensation */
    }
    
    .section-title {
        color: var(--text-primary);
        border-bottom: 3px solid var(--primary-blue);
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
        font-weight: 600;
    }
    
    body.dark-mode .section-title {
        color: #e0e0e0;
        border-bottom-color: var(--primary-blue);
    }
    
    .section-title i {
        color: var(--primary-blue);
        margin-right: 10px;
    }
    
    .info-card {
        background: var(--card-bg);
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 6px var(--card-shadow);
        border-left: 4px solid var(--primary-blue);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        color: var(--text-primary);
    }
    
    .info-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px var(--card-shadow);
    }
    
    .card-icon {
        color: var(--primary-blue);
        font-size: 2rem;
        margin-bottom: 1rem;
    }
    
    .card-title {
        color: var(--text-primary);
        font-weight: 600;
        margin-bottom: 1rem;
    }
    
    body.dark-mode .card-title {
        color: #e0e0e0;
    }
    
    .highlight-box {
        background-color: var(--highlight-bg);
        border-left: 4px solid var(--primary-blue);
        padding: 1.25rem;
        border-radius: 6px;
        margin: 1.5rem 0;
        color: var(--text-primary);
    }
    
    .team-member {
        text-align: center;
        padding: 1rem;
        background: var(--card-bg);
        border-radius: 8px;
        box-shadow: 0 4px 6px var(--card-shadow);
        margin-bottom: 1rem;
        color: var(--text-primary);
    }
    
    .fade-in {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
    }
    
    .fade-in.visible {
        opacity: 1;
        transform: translateY(0);
    }
    
    .badge-glass {
        background: rgba(26, 109, 187, 0.1);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
    }
    
    body.dark-mode .badge-glass {
        background: rgba(26, 109, 187, 0.2);
    }
    
    .active-nav-btn {
        background-color: var(--primary-blue) !important;
        color: white !important;
        border-color: var(--primary-blue) !important;
    }
    
    /* Styles pour les boutons dans la navigation */
    body.dark-mode .internal-nav-container .btn-outline-primary {
        color: #4dabf7;
        border-color: #4dabf7;
    }
    
    body.dark-mode .internal-nav-container .btn-outline-primary:hover {
        background-color: #4dabf7;
        color: #121212;
    }
    
    body.dark-mode .internal-nav-container .active-nav-btn {
        background-color: #4dabf7 !important;
        color: #121212 !important;
        border-color: #4dabf7 !important;
    }
    
    /* Styles pour le contenu texte */
    body.dark-mode p, 
    body.dark-mode li, 
    body.dark-mode .card-text {
        color: var(--text-secondary);
    }
    
    body.dark-mode .highlight-box p,
    body.dark-mode .highlight-box li {
        color: var(--text-primary);
    }
    
    @media (max-width: 768px) {
        .hospital-header h1 {
            font-size: 2rem;
        }
        
        .hospital-header {
            padding: 2rem 0;
        }
        
        .info-section {
            padding-top: 60px;
            margin-top: -40px;
        }
    }
</style>

<!-- Navigation interne FIXE -->
<nav id="internalNav" class="internal-nav-fixed">
  <div class="internal-nav-container">
    <div class="d-inline-flex gap-3 flex-wrap justify-content-center">
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#informations"><i class="bi bi-info-circle"></i> Informations</a>
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#formalites"><i class="bi bi-file-earmark-text"></i> Formalités</a>
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#sejour"><i class="bi bi-calendar-check"></i> Votre séjour</a>
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#bloc"><i class="bi bi-hospital"></i> Bloc opératoire</a>
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#accompagnement"><i class="bi bi-heart-pulse"></i> Accompagnement</a>
      <a class="btn btn-sm btn-outline-primary nav-link-btn" href="#sortie"><i class="bi bi-door-open"></i> Votre sortie</a>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="container hero py-5" style="margin-top: 40px;">
  <div class="glass-card p-4 d-flex flex-column flex-lg-row gap-4 align-items-center">
    <div class="flex-grow-1">
      <h1 class="display-6 fw-bold mb-2">Prise en charge du malade</h1>
      <p class="lead text-muted mb-3">Toutes les informations nécessaires pour votre séjour à l'EPH Sidi Ghilès, de l'admission à la sortie.</p>
      <div class="d-flex gap-2">
        <a href="#informations" class="btn btn-primary">Commencer</a>
        <a href="#formalites" class="btn btn-outline-primary">Documents nécessaires</a>
      </div>
    </div>
    <div class="d-flex align-items-center">
      <img src="{% static 'images/hospital-care.jpg' %}" alt="Prise en charge du malade" style="width:180px;height:120px;object-fit:cover;border-radius:8px;">
    </div>
  </div>
</section>

<!-- INFORMATIONS GENERALES -->
<section id="informations" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-info-circle"></i> Ce qu'il faut savoir</h2>
  
  <div class="glass-card p-4">
    <div class="row">
      <div class="col-md-8">
        <p class="text-muted">La consultation est un moment privilégié dans la compréhension et le traitement de votre maladie. Elle nécessite un dialogue personnel et un examen médical auprès d'un médecin.</p>
        <p class="text-muted">Les consultations sont assurées tous les jours matin et après-midi, du Dimanche au jeudi inclus. Des examens complémentaires (prise de sang, échographie, radiographie, etc.) peuvent être réalisés à l'issue de la consultation.</p>
        
        <div class="highlight-box">
          <p><strong><i class="fas fa-exclamation-triangle me-2"></i>En cas d'urgence :</strong> Contactez d'abord votre médecin traitant pour qu'il évalue si votre problème nécessite une consultation en urgence à l'EPH.</p>
          <p><strong><i class="fas fa-clipboard-check me-2"></i>Important :</strong> Munissez-vous de votre carte de santé ou de votre résumé standard de sortie lors de votre prise en charge.</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="team-member">
          <div class="badge-glass">
            <i class="fas fa-calendar-alt fs-4 text-primary"></i>
          </div>
          <h5>Horaires de consultation</h5>
          <p class="text-muted small">Du samedi au jeudi<br>Matin : 8h - 12h<br>Après-midi : 13h - 16h</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FORMALITES ET DOCUMENTS -->
<section id="formalites" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-file-alt"></i> Formalités et documents à fournir</h2>
  
  <div class="row g-4">
    <div class="col-md-4">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-file-medical fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Documents médicaux</h5>
        <ul class="small text-muted">
          <li>Tous documents médicaux utiles</li>
          <li>Lettres, radiographies, comptes rendus</li>
          <li>Examens de laboratoire récents</li>
          <li>Ordonnance de traitement en cours</li>
          <li>Carte de groupe sanguin (si disponible)</li>
        </ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-id-card fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Pièces d'identité</h5>
        <ul class="small text-muted">
          <li>Carte nationale d'identité</li>
          <li>Carte vitale avec attestation</li>
          <li>Carte de sécurité sociale</li>
          <li>Document d'hospitalisation</li>
          <li>Livret de famille (maternité)</li>
        </ul>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-user-md fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Coordonnées importantes</h5>
        <ul class="small text-muted">
          <li>Médecin traitant (nom, adresse, téléphone)</li>
          <li>Personne à prévenir en urgence</li>
          <li>Complémentaire santé</li>
          <li>Contact familial désigné</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- VOTRE SEJOUR -->
<section id="sejour" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-procedures"></i> Votre arrivée et séjour</h2>
  
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="glass-card p-4">
        <h5><i class="fas fa-sign-in-alt me-2 text-primary"></i>À votre arrivée</h5>
        <p class="text-muted">Selon le motif d'hospitalisation, l'entrée a lieu la veille, le jour même ou quelques jours avant si des examens complexes sont nécessaires.</p>
        
        <div class="highlight-box">
          <p><strong><i class="fas fa-ban me-2"></i>À jeun pour une intervention :</strong> Si vous êtes hospitalisé le matin de l'intervention, être à jeun à partir de minuit (ne pas manger, ne pas boire, ne pas fumer).</p>
        </div>
        
        <p class="text-muted">À votre arrivée, vous serez accueilli par l'infirmier(e) ou la surveillante du service qui vous conduira à votre chambre et vous fournira les explications nécessaires.</p>
        
        <h5 class="mt-4"><i class="fas fa-bed me-2 text-primary"></i>Conditions de séjour</h5>
        <p class="text-muted">La plupart des chambres sont des chambres de 2 à 3 lits, certaines disposant de toilettes privatives. Tous les services disposent de toilettes et douches collectifs avec eau chaude.</p>
        <p class="text-muted">Les services sont équipés de réfrigérateurs et de téléviseurs pour les patients. Tout est prévu pour votre confort pendant votre séjour.</p>
      </div>
    </div>
    
    <div class="col-lg-4">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-users fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Équipes soignantes</h5>
        <p class="text-muted small"><strong>Équipe soignante :</strong> Prend en charge les patients de façon personnalisée pour définir avec eux les objectifs de soins.</p>
        <p class="text-muted small"><strong>Équipe hôtelière :</strong> Assure l'hygiène des locaux et le service des repas, conciliant règles d'hygiène et confort des patients.</p>
        
        <div class="mt-3">
          <h6><i class="fas fa-user-nurse me-1 text-info"></i>Composition :</h6>
          <ul class="small text-muted">
            <li>Infirmiers et aides-soignants</li>
            <li>Surveillantes de soins</li>
            <li>Agents hôteliers</li>
            <li>Gouvernant(e)</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- BLOC OPERATOIRE -->
<section id="bloc" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-user-md"></i> Le bloc opératoire</h2>
  
  <div class="glass-card p-4">
    <p class="text-muted">Un programme opératoire est réparti du samedi au jeudi, avec des interventions d'urgence disponibles 24h/24 toute la semaine. Le bloc opératoire est situé au rez-de-chaussée.</p>
    
    <div class="row g-4 mt-3">
      <div class="col-md-4">
        <div class="team-member">
          <i class="fas fa-user-md fa-3x mb-3" style="color: #1a6dbb;"></i>
          <h6>Dr Brahimi Amar</h6>
          <p class="text-muted small">Médecin spécialiste en chirurgie générale<br>Responsable du bloc opératoire</p>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="team-member">
          <i class="fas fa-user-nurse fa-3x mb-3" style="color: #1a6dbb;"></i>
          <h6>Amrouche Rachid</h6>
          <p class="text-muted small">Cadre infirmier du bloc opératoire</p>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="team-member">
          <i class="fas fa-user-nurse fa-3x mb-3" style="color: #1a6dbb;"></i>
          <h6>Mantri Khaled</h6>
          <p class="text-muted small">Cadre infirmier du bloc opératoire</p>
        </div>
      </div>
    </div>
    
    <div class="row mt-4">
      <div class="col-md-6">
        <div class="info-card">
          <h6><i class="fas fa-hospital-alt me-2 text-primary"></i>Infrastructures</h6>
          <ul class="small text-muted">
            <li>05 salles d'opération</li>
            <li>1 salle dédiée Orthopédie-Traumatologie</li>
            <li>04 salles de chirurgie générale</li>
            <li>2 salles équipées d'appareils endoscopiques</li>
            <li>Unité de réanimation post-opératoire</li>
          </ul>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="info-card">
          <h6><i class="fas fa-clock me-2 text-primary"></i>Organisation</h6>
          <ul class="small text-muted">
            <li>Programmé du samedi au jeudi</li>
            <li>Urgences 24h/24 toute la semaine</li>
            <li>Séjour en réanimation : 6h à 24h</li>
            <li>Retour en hospitalisation normale généralement à 9h</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ACCOMPAGNEMENT SPECIALISE -->
<section id="accompagnement" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-hand-holding-heart"></i> Accompagnement spécialisé</h2>
  
  <div class="row g-4">
    <div class="col-md-6">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-pain-scale fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Prise en charge de la douleur</h5>
        <p class="text-muted small">Prévenir et soulager votre douleur est un engagement de tout le personnel de l'EPH.</p>
        <ul class="small text-muted">
          <li>Évaluation régulière (échelle de 0 à 10)</li>
          <li>Protocoles post-opératoires spécifiques</li>
          <li>Infirmière spécialisée en douleur</li>
          <li>Comité de Lutte contre la Douleur (CLUD)</li>
          <li>Plaquette d'information fournie</li>
        </ul>
        <div class="mt-3 highlight-box">
          <p class="small mb-0"><strong>Votre participation est essentielle :</strong> N'hésitez pas à parler de votre douleur au médecin anesthésiste et aux soignants.</p>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="info-card h-100">
        <div class="badge-glass">
          <i class="fas fa-brain fs-4 text-primary"></i>
        </div>
        <h5 class="card-title">Soutien psychologique et social</h5>
        <p class="text-muted small"><strong>Psychologues :</strong> En fonction de vos besoins, un psychologue peut intervenir durant votre hospitalisation.</p>
        <p class="text-muted small"><strong>Assistante sociale :</strong> À votre disposition pour vous conseiller et vous aider à résoudre vos difficultés (convalescence, aide à domicile, etc.).</p>
        
        <div class="mt-3">
          <h6><i class="fas fa-home me-1 text-info"></i>Hospitalisation à domicile (HAD)</h6>
          <p class="text-muted small">Disponible depuis 2006, rattachée au service de médecine interne.</p>
          <ul class="small text-muted">
            <li>10 lits d'hospitalisation à domicile</li>
            <li>Pour patients dont l'état le permet</li>
            <li>Équipe médicale mobile avec véhicule</li>
            <li>Intervention dans la daïra de Cherchell</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- VOTRE SORTIE -->
<section id="sortie" class="container py-5 info-section fade-in">
  <h2 class="section-title"><i class="fas fa-sign-out-alt"></i> Votre sortie</h2>
  
  <div class="glass-card p-4">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="info-card h-100">
          <div class="badge-glass">
            <i class="fas fa-calendar-check fs-4 text-primary"></i>
          </div>
          <h5 class="card-title">Préparation de la sortie</h5>
          <ul class="small text-muted">
            <li>Date déterminée par le chirurgien/médecin</li>
            <li>Organisation 24-48h avant avec la surveillante</li>
            <li>Préparez vos questions spécifiques</li>
            <li>Fournissez coordonnées médecin traitant</li>
            <li>Sorties le matin uniquement</li>
          </ul>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="info-card h-100">
          <div class="badge-glass">
            <i class="fas fa-file-medical-alt fs-4 text-primary"></i>
          </div>
          <h5 class="card-title">Dossier de sortie</h5>
          <ul class="small text-muted">
            <li>Ordonnances</li>
            <li>Rendez-vous de consultation</li>
            <li>Conseils diététiques si nécessaire</li>
            <li>Compte rendu opératoire (sur demande)</li>
            <li>Résultats d'examens (sur demande)</li>
            <li>Questionnaire de satisfaction</li>
          </ul>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="info-card h-100">
          <div class="badge-glass">
            <i class="fas fa-ambulance fs-4 text-primary"></i>
          </div>
          <h5 class="card-title">Organisation pratique</h5>
          <ul class="small text-muted">
            <li><strong>Convalescence :</strong> Réservation en centre si nécessaire</li>
            <li><strong>Transport :</strong> Ambulance sur prescription médicale</li>
            <li><strong>Administratif :</strong> Passage au service des admissions</li>
            <li><strong>Facturation :</strong> Téléphone et forfait journalier</li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="highlight-box mt-4">
      <h6><i class="fas fa-comments me-2 text-primary"></i>Information des familles</h6>
      <p class="mb-2">Afin d'éviter les appels multiples, désignez une personne parmi vos proches qui sera chargée de prendre de vos nouvelles.</p>
      <p class="small text-muted mb-0"><strong>Confidentialité :</strong> Aucune information médicale ne sera délivrée sans votre accord. Un proche peut prendre rendez-vous avec un médecin pour un entretien.</p>
    </div>
  </div>
</section>

<!-- ANIMATIONS & SCRIPTS -->
<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
<script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const internalNav = document.getElementById('internalNav');
    
    // Gestion du scroll pour la navbar fixe
    window.addEventListener('scroll', function() {
      if (window.scrollY > 50) {
        internalNav.classList.add('internal-nav-scrolled');
      } else {
        internalNav.classList.remove('internal-nav-scrolled');
      }
      
      // Mise à jour du bouton actif
      updateActiveNavLink();
    });
    
    // Fonction pour mettre à jour le lien actif
    function updateActiveNavLink() {
      const sections = document.querySelectorAll('section[id]');
      const navLinks = document.querySelectorAll('.nav-link-btn');
      
      let currentSection = '';
      const scrollPosition = window.scrollY + 100;
      
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        
        if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
          currentSection = section.getAttribute('id');
        }
      });
      
      navLinks.forEach(link => {
        link.classList.remove('active-nav-btn');
        if (link.getAttribute('href') === '#' + currentSection) {
          link.classList.add('active-nav-btn');
        }
      });
    }
    
    // Initialiser l'état actif
    updateActiveNavLink();
    
    // Fade-in animation
    gsap.utils.toArray('.fade-in').forEach(function(section) {
      gsap.from(section, {
        scrollTrigger: {
          trigger: section,
          start: "top 85%",
          toggleActions: "play none none reverse"
        },
        y: 20,
        opacity: 0,
        duration: 0.7
      });
    });

    // Glass cards animation
    gsap.utils.toArray('.glass-card').forEach(function(card, i) {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          start: "top 85%",
          toggleActions: "play none none reverse"
        },
        y: 20,
        opacity: 0,
        duration: 0.6,
        delay: i * 0.05
      });
    });

    // Info cards animation
    gsap.utils.toArray('.info-card').forEach(function(card, i) {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          start: "top 90%",
          toggleActions: "play none none reverse"
        },
        y: 15,
        opacity: 0,
        duration: 0.5,
        delay: i * 0.03
      });
    });

    // Hover effect on badges
    gsap.utils.toArray('.badge-glass').forEach(function(b) {
      b.addEventListener('mouseenter', () => gsap.to(b, {scale: 1.05, duration: 0.2}));
      b.addEventListener('mouseleave', () => gsap.to(b, {scale: 1, duration: 0.2}));
    });

    // Smooth scroll for internal navigation
    document.querySelectorAll('.nav-link-btn').forEach(a => {
      a.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href');
        const target = document.querySelector(targetId);
        if (!target) return;
        
        // Smooth scroll avec offset pour la navbar fixe
        const offset = 100;
        const targetPosition = target.offsetTop - offset;
        
        window.scrollTo({
          top: targetPosition,
          behavior: 'smooth'
        });
      });
    });
    
    // Animation for section titles
    gsap.utils.toArray('.section-title').forEach(function(title) {
      gsap.from(title, {
        scrollTrigger: {
          trigger: title,
          start: "top 90%",
          toggleActions: "play none none reverse"
        },
        x: -20,
        opacity: 0,
        duration: 0.6
      });
    });
    
    // Ajuster le padding du body si nécessaire
    function adjustBodyPadding() {
      const navbarHeight = document.querySelector('nav.navbar')?.offsetHeight || 70;
      const internalNavHeight = internalNav.offsetHeight;
      const totalHeight = navbarHeight + internalNavHeight + 20;
      
      document.body.style.paddingTop = totalHeight + 'px';
      
      // Ajuster aussi le margin-top du header
      document.querySelector('.hospital-header').style.marginTop = (internalNavHeight + 10) + 'px';
    }
    
    // Appeler au chargement et au redimensionnement
    adjustBodyPadding();
    window.addEventListener('resize', adjustBodyPadding);
  });
</script>

{% endblock %}
